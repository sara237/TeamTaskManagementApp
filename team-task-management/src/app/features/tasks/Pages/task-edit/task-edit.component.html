<h2 class="mb-4">{{ id ? 'Edit Task' : 'New Task' }}</h2>

<form [formGroup]="form" (ngSubmit)="save()" class="needs-validation" novalidate>
  
  <!-- Title -->
  <div class="mb-3">
    <label class="form-label">Title</label>
    <input formControlName="title" class="form-control" [ngClass]="{'is-invalid': form.get('title')?.touched && form.get('title')?.invalid}" />
    <div class="invalid-feedback" *ngIf="form.get('title')?.touched && form.get('title')?.invalid">
      Title is required
    </div>
  </div>

  <!-- Description -->
  <div class="mb-3">
    <label class="form-label">Description</label>
    <textarea formControlName="description" class="form-control"></textarea>
  </div>

  <!-- Status -->
  <div class="mb-3">
    <label class="form-label">Status</label>
    <select formControlName="status" class="form-select">
      <option [ngValue]="1">Todo</option>
      <option [ngValue]="2">In Progress</option>
      <option [ngValue]="3">Completed</option>
    </select>
  </div>

  <!-- Priority -->
  <div class="mb-3">
    <label class="form-label">Priority</label>
    <select formControlName="priority" class="form-select">
      <option [ngValue]="1">Low</option>
      <option [ngValue]="2">Medium</option>
      <option [ngValue]="3">High</option>
    </select>
  </div>

  <!-- Assignee -->
  <div class="mb-3">
    <label class="form-label">Assignee</label>
    <select formControlName="assignedUserId" class="form-select" [ngClass]="{'is-invalid': form.get('assignedUserId')?.touched && form.get('assignedUserId')?.invalid}">
      <option value="" disabled>Select a user</option>
      <option *ngFor="let u of users" [value]="u.id">{{ u.name }}</option>
    </select>
    <div class="invalid-feedback" *ngIf="form.get('assignedUserId')?.touched && form.get('assignedUserId')?.invalid">
      Assignee is required
    </div>
  </div>

  <!-- Due Date -->
  <div class="mb-3">
    <label class="form-label">Due Date</label>
    <input type="datetime-local" formControlName="dueDate" class="form-control" />
  </div>

  <!-- Buttons -->
  <div *ngIf="error" class="text-danger fw-semibold me-3">
    {{ error }}
  </div>
  <div class="d-flex align-items-center justify-content-center gap-3 mt-3">
    <button type="submit" class="btn btn-primary">Save</button>
    <a routerLink="/tasks" class="btn btn-secondary">Cancel</a>
  </div>

</form>
